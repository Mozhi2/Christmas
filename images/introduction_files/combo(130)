YUI.add("hermes-template-search-people-page-main",(function(e,n){var l=e.Template.Handlebars.revive({1:function(e,n,l,t,a){var r,o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return null!=(r=e.invokePartial(o(t,"result-card"),n,{name:"result-card",data:a,indent:"\t\t\t",helpers:l,partials:t,decorators:e.decorators}))?r:""},3:function(e,n,l,t,a){var r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'\t<div class="main search-empty-container">\n\t\t'+e.escapeExpression((r(l,"outlet")||n&&r(n,"outlet")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},null!=n?r(n,"search-empty-view"):n,{name:"outlet",hash:{},data:a,loc:{start:{line:11,column:2},end:{line:11,column:30}}}))+"\n\t</div>\n"},5:function(e,n,l,t,a){var r,o=null!=n?n:e.nullContext||{},s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'\t<div class="all-people hidden">\n\t\t<h5>'+(null!=(r=s(l,"if").call(o,null!=n?s(n,"scopedSearchTitle"):n,{name:"if",hash:{},fn:e.program(6,a,0),inverse:e.program(8,a,0),data:a,loc:{start:{line:16,column:6},end:{line:16,column:202}}}))?r:"")+'</h5>\n\t\t<div id="people-results-all">\n'+(null!=(r=s(l,"each").call(o,null!=(r=null!=n?s(n,"results"):n)?s(r,"allPeople"):r,{name:"each",hash:{},fn:e.program(13,a,0),inverse:e.noop,data:a,loc:{start:{line:18,column:3},end:{line:20,column:12}}}))?r:"")+"\t\t</div>\n\t</div>\n"},6:function(e,n,l,t,a){var r,o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return e.escapeExpression("function"==typeof(r=null!=(r=o(l,"scopedSearchTitle")||(null!=n?o(n,"scopedSearchTitle"):n))?r:e.hooks.helperMissing)?r.call(null!=n?n:e.nullContext||{},{name:"scopedSearchTitle",hash:{},data:a,loc:{start:{line:16,column:31},end:{line:16,column:52}}}):r)},8:function(e,n,l,t,a){var r,o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return null!=(r=o(l,"if").call(null!=n?n:e.nullContext||{},null!=n?o(n,"haveContacts"):n,{name:"if",hash:{},fn:e.program(9,a,0),inverse:e.program(11,a,0),data:a,loc:{start:{line:16,column:60},end:{line:16,column:195}}}))?r:""},9:function(e,n,l,t,a){var r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return e.escapeExpression((r(l,"intlMessage")||n&&r(n,"intlMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlMessage",hash:{intlName:"search.ALL_FLICKR_MEMBERS"},data:a,loc:{start:{line:16,column:80},end:{line:16,column:132}}}))},11:function(e,n,l,t,a){var r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return e.escapeExpression((r(l,"intlMessage")||n&&r(n,"intlMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlMessage",hash:{intlName:"search.FLICKR_MEMBERS"},data:a,loc:{start:{line:16,column:140},end:{line:16,column:188}}}))},13:function(e,n,l,t,a){var r,o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return null!=(r=e.invokePartial(o(t,"result-card"),n,{name:"result-card",data:a,indent:"\t\t\t\t",helpers:l,partials:t,decorators:e.decorators}))?r:""},compiler:[8,">= 4.3.0"],main:function(e,n,l,t,a){var r,o=null!=n?n:e.nullContext||{},s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="my-people hidden">\n\t<h5>'+e.escapeExpression((s(l,"intlMessage")||n&&s(n,"intlMessage")||e.hooks.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"search.PEOPLE_YOU_FOLLOW"},data:a,loc:{start:{line:2,column:5},end:{line:2,column:56}}}))+'</h5>\n\t<div id="people-results-my">\n'+(null!=(r=s(l,"each").call(o,null!=(r=null!=n?s(n,"results"):n)?s(r,"myPeople"):r,{name:"each",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:4,column:2},end:{line:6,column:11}}}))?r:"")+"\t</div>\n</div>\n"+(null!=(r=s(l,"if").call(o,null!=n?s(n,"showSafeSearchLimitedResults"):n,{name:"if",hash:{},fn:e.program(3,a,0),inverse:e.noop,data:a,loc:{start:{line:9,column:0},end:{line:13,column:7}}}))?r:"")+(null!=(r=s(l,"if").call(o,null!=n?s(n,"showSafeSearchLimitedResults"):n,{name:"if",hash:{},fn:e.noop,inverse:e.program(5,a,0),data:a,loc:{start:{line:14,column:0},end:{line:23,column:7}}}))?r:"")},usePartial:!0,useData:!0}),t={};e.Array.each(["result-card","result-card"],(function(n){var l=e.Template.get("hermes/"+n);l&&(t[n]=l)})),e.Template.register("hermes/search-people-page-main",(function(n,a){return(a=a||{}).partials=a.partials?e.merge(t,a.partials):t,l(n,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-result-card","hermes-template-result-card"]});YUI.add("hermes-template-search-people-page-view",(function(e,t){var l=e.Template.Handlebars.revive({1:function(e,t,l,n,a){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t<div class="fluid-centered">\n\t\t'+e.escapeExpression((r(l,"outlet")||t&&r(t,"outlet")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?r(t,"search-tools-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:7,column:2},end:{line:7,column:30}}}))+"\n\t</div>\n"},3:function(e,t,l,n,a){var r,o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t<div class="search-loading">\n'+(null!=(r=e.invokePartial(o(n,"flickr-balls"),t,{name:"flickr-balls",data:a,indent:"\t\t\t",helpers:l,partials:n,decorators:e.decorators}))?r:"")+"\t\t</div>\n"},5:function(e,t,l,n,a){var r,o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(r=o(l,"if").call(null!=t?t:e.nullContext||{},null!=t?o(t,"validResults"):t,{name:"if",hash:{},fn:e.program(6,a,0),inverse:e.program(12,a,0),data:a,loc:{start:{line:17,column:2},end:{line:40,column:9}}}))?r:""},6:function(e,t,l,n,a){var r,o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(r=(o(l,"isFlipped")||t&&o(t,"isFlipped")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"enable-search-sidebar",{name:"isFlipped",hash:{},fn:e.program(7,a,0),inverse:e.program(10,a,0),data:a,loc:{start:{line:18,column:3},end:{line:37,column:17}}}))?r:""},7:function(e,t,l,n,a){var r,o=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t\t\t<div class="search-container-w-sidebar">\n\t\t\t\t\t<div class="search-container-w-sidebar-content">\n\t\t\t\t\t\t'+e.escapeExpression((i(l,"outlet")||t&&i(t,"outlet")||e.hooks.helperMissing).call(o,null!=t?i(t,"search-tools-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:21,column:6},end:{line:21,column:34}}}))+"\n"+(null!=(r=e.invokePartial(i(n,"search-people-page-main"),t,{name:"search-people-page-main",data:a,indent:"\t\t\t\t\t\t",helpers:l,partials:n,decorators:e.decorators}))?r:"")+"\t\t\t\t\t</div>\n\n"+(null!=(r=i(l,"if").call(o,null!=t?i(t,"showSidebar"):t,{name:"if",hash:{},fn:e.program(8,a,0),inverse:e.noop,data:a,loc:{start:{line:25,column:5},end:{line:32,column:12}}}))?r:"")+"\n\t\t\t\t</div>\n"},8:function(e,t,l,n,a){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t\t\t\t\t<div class="sidebar-column">\n\t\t\t\t\t\t\t<div class="sidebar-column-spacer"></div>\n\t\t\t\t\t\t\t<div class="sidebar-content-container">\n\t\t\t\t\t\t\t\t'+e.escapeExpression((r(l,"outlet")||t&&r(t,"outlet")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?r(t,"search-sidebar-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:29,column:8},end:{line:29,column:38}}}))+"\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n"},10:function(e,t,l,n,a){var r,o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(r=e.invokePartial(o(n,"search-people-page-main"),t,{name:"search-people-page-main",data:a,indent:"\t\t\t\t",helpers:l,partials:n,decorators:e.decorators}))?r:""},12:function(e,t,l,n,a){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"\t\t\t"+e.escapeExpression((r(l,"outlet")||t&&r(t,"outlet")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?r(t,"search-empty-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:39,column:3},end:{line:39,column:31}}}))+"\n"},14:function(e,t,l,n,a){var r,o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(r=o(l,"if").call(null!=t?t:e.nullContext||{},null!=t?o(t,"validResults"):t,{name:"if",hash:{},fn:e.noop,inverse:e.program(15,a,0),data:a,loc:{start:{line:45,column:1},end:{line:47,column:8}}}))?r:""},15:function(e,t,l,n,a){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"\t\t"+e.escapeExpression((r(l,"outlet")||t&&r(t,"outlet")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?r(t,"footer-full-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:46,column:2},end:{line:46,column:29}}}))+"\n"},17:function(e,t,l,n,a){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"\t"+e.escapeExpression((r(l,"outlet")||t&&r(t,"outlet")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?r(t,"footer-full-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:49,column:1},end:{line:49,column:28}}}))+"\n"},compiler:[8,">= 4.3.0"],main:function(e,t,l,n,a){var r,o=null!=t?t:e.nullContext||{},i=e.hooks.helperMissing,s=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return s((u(l,"outlet")||t&&u(t,"outlet")||i).call(o,null!=t?u(t,"global-nav-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:1,column:0},end:{line:1,column:26}}}))+"\n\n"+s((u(l,"outlet")||t&&u(t,"outlet")||i).call(o,null!=t?u(t,"search-subnav-slender-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:3,column:0},end:{line:3,column:37}}}))+"\n\n"+(null!=(r=u(l,"if").call(o,null!=t?u(t,"validResults"):t,{name:"if",hash:{},fn:e.noop,inverse:e.program(1,a,0),data:a,loc:{start:{line:5,column:0},end:{line:9,column:7}}}))?r:"")+'\n<div class="main full-bleed fluid-centered" role="main">\n'+(null!=(r=u(l,"if").call(o,null!=t?u(t,"loading"):t,{name:"if",hash:{},fn:e.program(3,a,0),inverse:e.program(5,a,0),data:a,loc:{start:{line:12,column:1},end:{line:41,column:8}}}))?r:"")+"</div>\n\n"+(null!=(r=u(l,"if").call(o,null!=t?u(t,"showSidebar"):t,{name:"if",hash:{},fn:e.program(14,a,0),inverse:e.program(17,a,0),data:a,loc:{start:{line:44,column:0},end:{line:50,column:7}}}))?r:"")},usePartial:!0,useData:!0}),n={};e.Array.each(["flickr-balls","search-people-page-main","search-people-page-main"],(function(t){var l=e.Template.get("hermes/"+t);l&&(n[t]=l)})),e.Template.register("hermes/search-people-page-view",(function(t,a){return(a=a||{}).partials=a.partials?e.merge(n,a.partials):n,l(t,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-flickr-balls","hermes-template-search-people-page-main","hermes-template-search-people-page-main"]});YUI.add("collection-paginator",(function(e){var t=e.CollectionPaginator=function(e,t,i){i&&i.page?this.page=this.startPage=i.page-1:this.page=this.startPage=0,i&&i.fetchPageSize?this.perPage=i.fetchPageSize:this.perPage=100,i&&i.viewPageSize?this.viewPageSize=i.viewPageSize:this.viewPageSize=Number.MAX_VALUE,i&&i.apiParams&&(this.apiParams=i.apiParams),this.lastPage=this.startPage+Math.ceil(this.viewPageSize/this.perPage),this.modelProxy=e,this.listAttr=t,this.prepending=!1,this._advanceToFirstIncompletePage(),this.valuesChangedHandle=this.modelProxy.on("valuesChanged",this._onValuesChanged.bind(this),!0)};t.prototype={passAttributesToFetcher:function(e){this.fetcherParamAttrs=e instanceof Array?e:[e]},next:function(e){return this.page<this.lastPage&&this.page++,this._getPage()},prev:function(e){return this.page>0&&this.page--,this._getPage()},getCollectionAsList:function(){return this.modelProxy.getValue(this.listAttr).getList()},getCurrentPageAsList:function(){var t=this.modelProxy.getValue(this.listAttr).getList(),i=this.startPage*this.perPage,s=i+this.viewPageSize;if(!i||isNaN(i))throw new Error("Unexpected page parameters in collection-paginator");return(t=t.slice(i,s)).length&&(t=e.FlickrCollection.trimArray(t)),t},currentPageIsLoaded:function(){return this.getCurrentPageAsList().length===this.viewPageSize||this.modelProxy.getValue(this.listAttr).fetchedEnd},_getPage:function(){var e,t={},i=this.modelProxy.getValue(this.listAttr).getList(),s=(this.page-1)*this.perPage,a=this.page*this.perPage,r=this.startPage*this.perPage+this.viewPageSize,h=!1,g=this;if(this.viewPageSize<1e3&&this.page&&this.perPage){for(e=a+1;e<r;e++)if(void 0!==i[e]){h=!0;break}if(h)for(e=s;e<a;e++)if(void 0===i[e]){this.prepending=!0;break}}if(this.page&&(t.page=this.page),this.perPage&&(t.perPage=this.perPage),this.fetcherParamAttrs&&this.fetcherParamAttrs.forEach((function(e){t[e]=g.modelProxy.getValue(e)})),this.apiParams)for(const[e,i]of Object.entries(this.apiParams))t[e]=i;return this.modelProxy.getValue(this.listAttr).getPage(t)},_onValuesChanged:function(e){var t;e[this.listAttr]&&e[this.listAttr].listDiff&&(t=e[this.listAttr].listDiff,this.prepending&&(this.prepending=!1,t.prepended=t.added),this.fire("listValueChanged",t))},_advanceToFirstIncompletePage:function(){var e,t=this.modelProxy.getValue(this.listAttr).getList();if(this.viewPageSize===Number.MAX_VALUE)this.page=Math.floor(this.getCollectionAsList().length/this.perPage);else for(;this.page<this.lastPage&&(e=t.slice(this.page*this.perPage,(this.page+1)*this.perPage)).length>=this.perPage&&e.every((function(e){return void 0!==e}));)this.page++}},e.augment(t,e.EventTarget)}),"@VERSION@",{requires:["event-custom","flickr-collection"]});YUI.add("search-people-page-view",(function(e){"use strict";e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,stillLoadingResults:!1,initializer:function(t){return this.searchParams=t.searchParams||{},this.searchParams.all?this.apiParams=e.merge(this.searchParams.all.apiParams):this.apiParams={},this.searchUrl=new e.SearchUrl(this.apiParams,this.appContext,e.SearchUrl.searchTypes.PEOPLE),this.apiFailed=t.apiFailed,this.searchTerm=t.searchTerm,this.allResults={collectionModel:null,paginator:null,renderedPages:[]},this.contactsResults={collectionModel:null,paginator:null,renderedPages:[]},this.scrollInterruptParams={pageCounts:[5],footerToHideWhileScrolling:".footer-full-view"},this.scrollInterruptState={nextInterrupt:this.scrollInterruptParams.pageCounts[0],numPagesLoaded:0,numInterrupts:0,isInterrupted:!1,footer:null,footerHeight:0},this.showSafeSearchLimitedResults=!1,this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-subnav-slender-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-empty-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-sidebar-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,isPeopleSearch:!0,disabled:function(){return!this.appContext.flipper.isFlipped("enable-search-sidebar")||this.isMobile}},"search-tools-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,showFilterMenus:!0,showSafeSearchFilter:!0},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var t=this,s={},a=["username","userId","loadFullContact"],r=["username","loadFullContact"];return YUI.Env.isServer||this.apiFailed||!this.searchParams?e.Promise.resolve():(this.searchParams.all&&(s.all=this.appContext.getModel("search-contacts-models",this.searchParams.all.id,this.searchParams.all.apiParams),this.searchParams.all.apiParams&&this.searchParams.all.apiParams[e.SearchHelper.PEOPLE_SEARCH_API.userId]&&(r.push("userId"),s.allTitle=e.SearchHelper.derivePeopleScopeTitle(this.searchParams.all.apiParams,this.appContext))),this.searchParams.contacts&&(s.contacts=this.appContext.getModel("search-contacts-models",this.searchParams.contacts.id,this.searchParams.contacts.apiParams)),e.FlickrPromise(s).then((function(s){if(s.all&&s.all.getValue("contacts").size()){t.validResults=!0,t.allResults.collectionModel=s.all;var l={fetchPageSize:t.searchParams.all.apiParams.perPage};l.apiParams=t.searchParams.all.apiParams,t.allResults.paginator=new e.CollectionPaginator(t.allResults.collectionModel,"contacts",l),t.allResults.paginator.page=Math.ceil(s.all.getValue("contacts").size()/t.searchParams.all.apiParams.perPage),t.allResults.paginator.passAttributesToFetcher(r),s.allTitle&&(t.scopedSearchTitle=t.intlMessage(s.allTitle)),s.all&&1===s.all.getValue("adjSearchArgs")&&(t.showSafeSearchLimitedResults=!0,t.subviews["search-empty-view"].set("safeSearchLimitedResults",t.buildSafeSearchLimitedResultsMessage()),t.subviews["search-empty-view"].fire("parentViewEvent","error-msg-updated"))}else s.all&&(s.all&&1===s.all.getValue("adjSearchArgs")?(t.showSafeSearchLimitedResults=!0,t.subviews["search-empty-view"].set("safeSearchLimitedResults",t.buildSafeSearchLimitedResultsMessage()),t.subviews["search-empty-view"].fire("parentViewEvent","error-msg-updated")):(t.subviews["search-empty-view"].set("noMatchesForQuery",t.buildNoMatchesFoundMessage()),t.subviews["search-empty-view"].fire("parentViewEvent","error-msg-updated")));s.contacts&&s.contacts.getValue("contacts").size()&&(t.validResults=!0,t.haveContacts=!0,t.contactsResults.collectionModel=s.contacts,t.contactsResults.paginator=new e.CollectionPaginator(t.contactsResults.collectionModel,"contacts",{fetchPageSize:t.searchParams.contacts.apiParams.perPage}),t.contactsResults.paginator.page=Math.ceil(s.contacts.getValue("contacts").size()/t.searchParams.contacts.apiParams.perPage),t.contactsResults.paginator.passAttributesToFetcher(a))})))},buildHeadContainer:function(){var t,s=this.intlMessage({intlName:"search.FLICKR_SEARCH"})+" — "+this.intlMessage({intlName:"search.PEOPLE"})+(this.searchTerm?": “"+this.searchTerm+"”":"");t=this.templates("dynamic-page-head")({title:s,url:this.searchUrl.getURL(),oembedURL:this.searchUrl?encodeURIComponent(e.url(this.searchUrl.getURL())):null,fullURL:this.searchUrl?e.url(this.searchUrl.getURL()):null,ogType:"article",ownerURL:e.url(),twitterCardType:"summary",openGraphImageURL:"https://combo.staticflickr.com/pw/images/favicons/favicon-228.png"}),t+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, viewport-fit=cover, initial-scale=1, maximum-scale=1"}),this.set("headContainer",t),YUI.Env.isServer||this.updateHead()},buildContainer:function(){return this.setContainerWithTemplate("search-people-page-view",{loading:YUI.Env.isServer,results:{myPeople:[],allPeople:[]},validResults:this.validResults,haveContacts:this.haveContacts,scopedSearchTitle:this.scopedSearchTitle,showSidebar:this.appContext.flipper.isFlipped("enable-search-sidebar")&&!this.isMobile&&!this.showSafeSearchLimitedResults,showSafeSearchLimitedResults:this.showSafeSearchLimitedResults}),this},activate:function(){if(this.validResults)return this.buildContainer(),this.contactsResults.collectionModel&&this.renderContacts(this.contactsResults.collectionModel.getValue("contacts").getList(),!0),this.allResults.collectionModel&&this.renderContacts(this.allResults.collectionModel.getValue("contacts").getList(),!1),this.registerEventHandler(e.globalEvents.subscribe("window:scroll",this.handleScroll.bind(this))),e.Snowplough&&this.searchTerm&&e.Snowplough.sendSearchEvent({keyword:this.apiParams.username,category:"people",totalResults:this.allResults&&this.allResults.collectionModel?this.allResults.collectionModel.getValue("totalItems"):0,pageResults:this.allResults&&this.allResults.collectionModel?this.allResults.collectionModel.getValue("contacts").getList().length:0}),this;this.buildContainer({loading:!1,validResults:!1})},buildNoMatchesFoundMessage:function(){var t;return t=this.searchTerm?"search.NO_MATCHES_FOR_QUERY_TERM_WITH_SETTINGS":"search.NO_MATCHES_FOR_QUERY",{noMatchesText:this.searchTerm?this.intlMessage({intlName:t,searchTerm:e.flutil.unescape(this.searchTerm)}):this.intlMessage({intlName:t})}},buildSafeSearchLimitedResultsMessage:function(){return{safeSearchLimitedResultsText:this.intlMessage({intlName:"search.SAFESEARCH_IS_ON"}),safeSearchLimitedResultsButtonText:this.intlMessage({intlName:"search.CHANGE_SAFESEARCH"}),showSafeSearchDropdown:!0}},loadNextPage:function(t){var s,a=t?this.contactsResults:this.allResults,r=this;if(this.scrollInterruptState.footer||(this.scrollInterruptState.footer=e.one(this.scrollInterruptParams.footerToHideWhileScrolling),this.scrollInterruptState.footer&&(this.scrollInterruptState.footerHeight=this.scrollInterruptState.footer.get("clientHeight"))),a&&a.paginator&&!((s=a.collectionModel?a.collectionModel.getValue("contacts"):null).fetchedEnd&&a.paginator.page>=s.totalPages))return this.stillLoadingResults=!0,this.get("showThrobberDuringLoad")&&this.toggleThrobber(!0),a.paginator.next().then(function(e){r.stillLoadingResults=!1,r.get("showThrobberDuringLoad")&&r.toggleThrobber(!1),e&&(r.renderContacts(e,t),t||s.fetchedEnd||(r.scrollInterruptState.numPagesLoaded++,r.checkScrollInterruptionState(),r.handleScroll(null)))}.bind(this)).catch(e.PromiseCatcher(r.name))},renderContacts:function(t,s){var a,r=[],l=this.get("container"),i=this;return e.Array.each(t,(function(t){if(t){var s,a,o={isPro:t.getValue("isPro"),proBadge:t.getValue("proBadge"),link:t.getValue("profileURL"),avatar:{type:"person",title:t.getValue("username"),url:t.getValue("buddyicon").medium,personNsid:t.getValue("nsid")},title:{text:t.getValue("realname")||t.getValue("username")},subtitles:[t.getValue("username")||""],links:[],linksMetadata:i.intlMessage({intlName:"search.JOINED_DATE",intlDate:t.getValue("dateJoined").toDate()}),cta:{followPlaceholderId:"follow"+t.getValue("nsid").replace("@","")}};s=e.IntlNumber.format(t.getValue("photosCount"),i.appContext.lang,1),a=e.IntlNumber.format(t.getValue("followersCount"),i.appContext.lang,1),t.getValue("photosCount")&&o.links.push({url:t.getValue("profileURL"),text:'<i class="photos-icon"></i>'+s}),t.getValue("followersCount")&&o.links.push({url:t.getValue("profileURL"),text:'<i class="members-icon"></i>'+a}),i.instantiateSubview("follow-view",{nsid:t.getValue("nsid"),pathAlias:t.getValue("pathAlias")}).then((function(e){return e.initialize()})).then((function(e){l.one("#"+o.cta.followPlaceholderId).replace(e.get("container")),e.normalizedActivate()})),r.push(o)}})),a=this.templates("result-cards")({results:r}),s?(this.contactsResults.renderedPages.push(a),t.length>0&&(l.one("#people-results-my").append(a),l.one(".my-people").removeClass("hidden"))):(this.allResults.renderedPages.push(a),t.length>0&&l.one("#people-results-all")&&(l.one("#people-results-all").append(a),l.one(".all-people").removeClass("hidden"))),a},handleScroll:function(t){if(!(this.allResults.collectionModel&&this.allResults.collectionModel.getValue("contacts").fetchedEnd||this.scrollInterruptState.isInterrupted)){var s=this.get("container"),a=this.appContext.viewportData.getHeight(),r=s.get("clientHeight"),l=e.config.win.pageYOffset,i=s.getY()+r,o=l+a;!this.stillLoadingResults&&i-o<5*a&&this.loadNextPage()}},checkScrollInterruptionState:function(e){var t;if((this.scrollInterruptState||e)&&this.scrollInterruptState.numPagesLoaded>=this.scrollInterruptState.nextInterrupt){if(this.scrollInterruptState.numInterrupts++,t=this.scrollInterruptParams.pageCounts[this.scrollInterruptParams.pageCounts.length-1],this.scrollInterruptState.numInterrupts>=this.scrollInterruptParams.pageCounts.length)if("exponential"===this.scrollInterruptParams.repeatMode)this.scrollInterruptState.nextInterrupt+=t*Math.pow(2,this.scrollInterruptState.numInterrupts-this.scrollInterruptParams.pageCounts.length);else this.scrollInterruptState.nextInterrupt+=t;else this.scrollInterruptState.nextInterrupt+=this.scrollInterruptParams.pageCounts[this.scrollInterruptState.numInterrupts];e||this.interruptScroll()}},interruptScroll:function(){this.scrollInterruptState.isInterrupted||(this.scrollInterruptState.isInterrupted=!0,this.scrollInterruptState.loadMoreElement||(this.scrollInterruptState.loadMoreElement=e.Node.create(this.templates("infinite-scroll-load-more")({}))),this.get("container").append(this.scrollInterruptState.loadMoreElement),this.scrollInterruptState.loadMoreElementHeight||(this.scrollInterruptState.loadMoreElementHeight=this.scrollInterruptState.loadMoreElement.get("clientHeight"),this.registerEventHandler(this.scrollInterruptState.loadMoreElement.on("click",this.onLoadMoreClicked.bind(this)))))},onLoadMoreClicked:function(e){this.scrollInterruptState.isInterrupted&&(this.scrollInterruptState.isInterrupted=!1,this.scrollInterruptState.loadMoreElement.remove(),this.loadNextPage())},toggleThrobber:function(e){var t=this.get("container");void 0===e&&(e=!this.get("isThrobberShowing")),e?this.get("throbberNode").appendTo(t):this.get("throbberNode").remove(),this._set("isThrobberShowing",e)}},{ATTRS:{showThrobberDuringLoad:{value:!0,validator:function(t,s){return e.AttributeHelpers.validateBoolean(t)}},isThrobberShowing:{readOnly:!0,value:!1},throbberNode:{readOnly:!0,getter:function(t){if(!YUI.Env.isServer&&void 0===t){let s=this.templates("flickr-balls")({});t=e.Node.create('<div class="flickr-balls-container">'+s+"</div>"),this._set("throbberNode",t)}return t}}}})}),"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","search-url","hermes-template-search-people-page-view","hermes-template-search-people-page-main","hermes-template-infinite-scroll-load-more","hermes-template-result-card","hermes-template-result-cards","hermes-template-flickr-balls","collection-paginator","follow-view","search-empty-view","search-sidebar-view","intl-number"],langBundles:["search","common"]});YUI.add("search-people-route",(function(e,r){var a=require("hermes-core/flog")(r);function s(e){s.superclass.constructor.call(this,e)}e.Routes[this.name]=s,e.extend(s,e.FlickrRoute,{langBundles:this.details.langBundles,run:function(r){var s,t={},i=this,l={};return t.apiParams=this.processRequest(r),t.viewerNsid=r.probableUser||this.appContext.getViewer().nsid,(s=this.generateSearchParams(t)).all&&(l.all=this.appContext.getModel("search-contacts-models",s.all.id,s.all.apiParams)),s.contacts&&(l.contacts=this.appContext.getModel("search-contacts-models",s.contacts.id,s.contacts.apiParams)),e.FlickrPromise(l).then((function(r){var a=t.apiParams&&t.apiParams.username,l=i.intlMessage({intlName:"search.SEARCH"});return void 0!==a&&(l+=": "+a),e.Promise.resolve({title:l,view:"search-people-page-view",params:{searchParams:s,searchType:e.SearchUrl.searchTypes.PEOPLE,modelParams:t,searchTerm:a}})}),(function(r){a.error({err:r});var s=t.apiParams&&t.apiParams.username,l=i.intlMessage({intlName:"search.SEARCH"});return void 0!==s&&(l+=": "+s),e.Promise.resolve({title:l,view:"search-people-page-view",params:{searchTerm:s,apiFailed:!0}})}))},generateSearchParams:function(r){var a,s={},t=r.apiParams||{};return e.SearchHelper.isParameterlessSearch(t)||(this.shouldPerformAllPeopleSearch(r,t)&&(a=new e.SearchUrl(t,this.appContext,e.SearchUrl.searchTypes.PEOPLE),s.all={id:a.getId(),apiParams:e.merge(a.getAPIParams(),{perPage:50})}),this.shouldPerformContactsSearch(r,t)&&(a=new e.SearchUrl(e.merge(t,{user_id:r.viewerNsid}),this.appContext,e.SearchUrl.searchTypes.PEOPLE),s.contacts={id:a.getId(),apiParams:e.merge(a.getAPIParams(),{perPage:200})})),s},shouldPerformAllPeopleSearch:function(r,a){return!!a[e.SearchHelper.PEOPLE_SEARCH_API.username]},shouldPerformContactsSearch:function(r,a){return a[e.SearchHelper.PEOPLE_SEARCH_API.username]&&r.viewerNsid&&!a[e.SearchHelper.PEOPLE_SEARCH_API.userId]},processRequest:function(r){var a=null;return a=e.SearchHelper.mapClassicPeopleSearchToAPI(r.query,this.appContext),r.query.text&&(a.username=r.query.text),e.SearchHelper.addPeopleParamDefaults(a),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(a),a}}),e.mix(s.prototype,e.Localizable)}),"@VERSION@",{requires:["flickr-route","flickr-promise","search-helper","querystring-stringify-simple","localizable","url","search-url","search-people-page-view"],optionalRequires:["hermes-core"],langBundles:["search"]});