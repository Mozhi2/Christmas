YUI.add("search-contact-models",(function(e){"use strict";function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return e}},username:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},iconfarm:{},iconserver:{},buddyicon:{},nsid:{readOnly:!0,defaultFn:function(e){return e}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}},profileURL:{readOnly:!0,derivedBy:["pathAlias","nsid"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return t||(t=e),"/photos/"+t}},followsURL:{readOnly:!0,derivedBy:["pathAlias","nsid"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return t||(t=e),"/people/"+t+"/contacts"}},isContact:{defaultValue:!1,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isFriend:{defaultValue:!1,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isFamily:{defaultValue:!1,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},followersCount:{defaultValue:0,setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},photosCount:{defaultValue:0,setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},videosCount:{defaultValue:0,setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},hometown:{defaultValue:"",setter:function(t){return e.AttributeHelpers.coerceString(t)}},isIgnored:{defaultValue:!1,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},dateJoined:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},defaultFn:function(t){return e.moment()},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},isPro:{defaultValue:!1,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proBadge:{defaultValue:"standard",setter:function(t){return e.AttributeHelpers.coerceString(t)}}}})}),"@VERSION@",{requires:["flickr-model-registry","attribute-helpers","url-helper","moment"]});YUI.add("flickr-people-search-fetcher",(function(e,o){"use strict";e.namespace("ListFetchers")["flickr-people-search"]={run:function(t,r){var a=this,s=this._processParams(t);return s.username||(t.emptyQuery=!0),t.loadFullContact?e.Promise.all([t.emptyQuery?e.Promise.resolve({people:{person:[]}}):r.callAPI("flickr.people.search",s),r.getModelRegistry("search-contact-models"),r.getModelRegistry("search-contacts-models"),r.getModelRegistry("person-relationship-models")]).then((function(e){return a._processFullResponse(e,t,r)}),(function(e){throw 2===e.code&&"Photo not in people search"===e.message&&(e.notInContext=!0),e})).then(null,e.FetcherErrorLogger(o)):e.Promise.all([r.callAPI("flickr.people.search",s),r.getModelRegistry("contact-models")]).then((function(e){return a._processResponse(e,t)}),(function(e){throw 2===e.code&&"Photo not in people search"===e.message&&(e.notInContext=!0),e})).then(null,e.FetcherErrorLogger(o))},_processParams:function(o){var t;return o||(o={}),t={username:o.username||o.text,exact:o.exact||0,extras:"path_alias,rev_ignored,rev_contacts,is_pro,icon_urls",per_page:o.perPage||100,page:o.page||1},o.loadFullContact&&(o.userId&&(t.user_id=o.userId),t.extras+=",location,rev_contact_count,use_vespa,date_joined",t.show_more=1),delete(t=e.merge(t,o)).text,delete t.userId,delete t.id,t},_processResponse:function(e,o){var t,r=e[0],a=e[1];return t={people:[],pages:r.people.pages},r.people&&r.people.person&&r.people.person.forEach((function(e){t.people.push(a.addOrUpdate({id:e.nsid,username:e.username,realname:e.realname,iconfarm:e.iconfarm,iconserver:e.iconserver,pathAlias:e.pathAlias}))})),t},_processFullResponse:function(e,o,t){var r,a,s=e[0],n=e[1],p=e[2],l=e[3],i={},c=[];if(s.people.person.forEach((function(e){i={id:e.nsid,username:e.username,realname:e.realname,buddyicon:e.iconurls,iconfarm:e.iconfarm,iconserver:e.iconserver,pathAlias:e.pathAlias,isContact:e.contact,isFriend:e.friend,isFamily:e.family,photosCount:e.publicPhotosCount,videosCount:e.videoCount,followersCount:e.revContactCount,isIgnored:e.ignored,isIgnoredBy:e.revIgnored,isRevContact:e.revContact,isRevFriend:e.revFriend,isRevFamily:e.revFamily,dateJoined:e.date_joined,isPro:e.is_pro,proBadge:e.proBadge},e.city&&e.country?i.hometown=e.city+", "+e.country:e.city?i.hometown=e.city:e.country&&(i.hometown=e.country),c.push(n.addOrUpdate(i)),l&&l.addOrUpdate(i)})),r={perPage:s.people.per_page,page:s.people.page||1,pageContent:c,totalItems:s.people.total,totalPages:s.people.pages},s.people.maxAllowedResults&&(r.totalItems=Math.min(s.people.maxAllowedResults,s.people.total)),s.people.maxAllowedPages&&(r.totalPages=Math.min(s.people.maxAllowedPages,s.people.pages)),a)for(a=r.pageContent.length;a<r.perPage;a++)r.pageContent.push(!1);return p.addOrUpdate({id:o.id,contacts:r,totalItems:s.people.total,totalPages:r.totalPages,username:o.username,userId:o.userId}),1===s.people.adjSearchArgs&&p.addOrUpdate({id:o.id,adjSearchArgs:s.people.adjSearchArgs}),c}}}),"@VERSION@",{requires:["api-helper","flickr-promise"],optional:["contact-models","search-contact-models","person-relationship-models"]});YUI.add("search-contacts-models",(function(e){"use strict";function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return t.loadFullContact=!0,e.ListFetchers["flickr-people-search"].run(t,this.appContext)}},attributes:{id:{},username:{},userId:{},loadFullContact:{getter:function(e,t){return!0}},contacts:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-search"]}},totalItems:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},adjSearchArgs:{defaultValue:0}}})}),"@VERSION@",{requires:["attribute-helpers","flickr-model-registry","flickr-people-search-fetcher"]});